import torch
import torch.nn as nn
import torch.nn.functional as F

class Net(nn.Module):
    def __init__(self):
        super(Net, self).__init__()
        self.conv1 = nn.Conv1d(in_channels=1, out_channels=16, kernel_size=3)
        self.fc1 = nn.Linear(16 * 33, 160)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        x = x.view(x.size(0), -1)
        x = self.fc1(x)
        x = x.view(x.size(0), 160, 1)
        x = torch.transpose(x, 1, 2)
        print(x)
        return x

# 创建模型实例
model = Net()

# 创建输入数据
input_data = torch.randn(1, 1, 35)  # 输入数据为1x35

# 前向传播
output = model(input_data)

"""
tensor([[[ 4.4583e-01],
         [ 3.6257e-01],
         [-1.8021e-01],
         [ 2.5535e-01],
         [ 2.1109e-01],
         [ 1.0249e-01],
         [-3.0725e-01],
         [-2.2107e-01],
         [ 2.6854e-01],
         [ 3.2134e-01],
         [ 1.4222e-02],
         [-4.1111e-02],
         [ 3.3939e-01],
         [-1.0617e-01],
         [-5.4588e-01],
         [-7.9020e-02],
         [ 8.4374e-02],
         [-1.8931e-01],
         [ 3.2023e-01],
         [-1.7996e-01],
         [ 4.2824e-02],
         [-9.1792e-02],
         [ 2.2421e-01],
         [-2.0076e-01],
         [ 2.2792e-01],
         [ 1.9491e-01],
         [ 1.7439e-02],
         [ 4.4483e-01],
         [ 8.4962e-03],
         [ 1.5014e-01],
         [ 1.4014e-01],
         [ 3.3139e-01],
         [-1.2932e-01],
         [-1.3462e-02],
         [-2.3585e-01],
         [ 2.7109e-01],
         [-3.5453e-01],
         [-2.9550e-01],
         [-8.1567e-02],
         [ 3.1931e-01],
         [ 1.8676e-02],
         [-4.3700e-01],
         [-1.2222e-01],
         [-1.5744e-01],
         [ 8.2646e-02],
         [ 3.5762e-01],
         [ 3.5088e-02],
         [ 1.0395e-01],
         [ 1.3270e-01],
         [ 6.1239e-02],
         [-5.3770e-02],
         [-3.9952e-01],
         [-4.3236e-02],
         [-6.9424e-02],
         [ 1.5548e-01],
         [ 4.9887e-02],
         [ 1.6300e-02],
         [ 6.0621e-02],
         [-8.9063e-02],
         [-4.1984e-01],
         [ 4.5036e-02],
         [ 1.6312e-01],
         [ 1.2452e-02],
         [ 7.0337e-01],
         [ 4.5541e-01],
         [-6.1986e-01],
         [ 2.1721e-01],
         [ 1.1328e-01],
         [ 2.9869e-01],
         [-2.3522e-02],
         [-2.0418e-01],
         [-2.5187e-01],
         [-2.8267e-01],
         [-2.7016e-01],
         [-1.5488e-01],
         [-2.0553e-01],
         [ 1.3051e-02],
         [-2.2006e-01],
         [-2.5534e-01],
         [ 1.9792e-01],
         [-2.7075e-01],
         [-2.1821e-01],
         [ 3.9015e-01],
         [-8.4671e-02],
         [ 1.2542e-01],
         [-1.5608e-01],
         [-2.3627e-01],
         [-6.8266e-02],
         [-2.2226e-01],
         [-9.4942e-02],
         [-3.9172e-01],
         [-6.8079e-04],
         [-2.7623e-01],
         [ 3.2303e-01],
         [-9.9225e-02],
         [ 3.9576e-01],
         [-2.2239e-01],
         [ 2.6140e-01],
         [ 1.0387e-01],
         [ 1.1234e-01],
         [-1.5584e-01],
         [-1.4169e-01],
         [-2.2774e-01],
         [ 2.4077e-02],
         [ 5.6288e-02],
         [ 5.2446e-01],
         [ 2.9831e-01],
         [-4.4402e-01],
         [ 1.8702e-01],
         [ 3.6781e-02],
         [-3.5599e-01],
         [-3.6545e-02],
         [-5.3510e-01],
         [-7.0895e-02],
         [-6.5857e-02],
         [ 6.7863e-02],
         [ 3.7105e-01],
         [ 7.2490e-02],
         [-1.4869e-01],
         [ 3.2155e-01],
         [ 4.0686e-01],
         [-3.4956e-01],
         [ 1.6960e-01],
         [-1.8641e-02],
         [-2.4608e-01],
         [ 9.4916e-02],
         [ 3.3675e-01],
         [-2.6812e-01],
         [ 1.6708e-01],
         [-2.4326e-01],
         [ 5.6494e-03],
         [-8.9507e-02],
         [-5.0725e-01],
         [ 2.5469e-01],
         [-1.3830e-02],
         [ 2.6227e-01],
         [ 4.3546e-02],
         [-1.4248e-01],
         [-3.1389e-01],
         [-3.4073e-01],
         [ 1.1594e-01],
         [ 2.2936e-01],
         [-2.5263e-01],
         [ 4.9514e-01],
         [ 1.5244e-01],
         [-3.9149e-02],
         [ 5.2092e-02],
         [-6.3884e-02],
         [-6.9027e-03],
         [-1.8148e-01],
         [-2.3552e-01],
         [-3.0244e-01],
         [ 2.1846e-01],
         [-1.6204e-01],
         [-1.5475e-01],
         [ 2.5139e-01],
         [-3.2598e-01],
         [ 3.9607e-01],
         [-3.0197e-01],
         [-2.1114e-02]]], grad_fn=<ViewBackward0>)
"""